/*
 * wave_lookup.c
 *
 *  Created on: 20 Jan 2022
 *      Author: ray
 */

#include "wave_lookup.h"

const int sine_table[40] = {0, 		5126, 		10126, 		14876, 		19260, 		23170, 		26509, 		29196, 		31163, 		32364,
							32767, 	32364, 		31163, 		29196, 		26509, 		23170, 		19260, 		14876, 		10126, 		5126,
							0, 		-5126, 		-10126,		-14876, 	-19260, 	-23170, 	-26509, 	-29196, 	-31163, 	-32364,
							-32767, -32364, 	-31163, 	-29196, 	-26509, 	-23170, 	-19260, 	-14876, 	-10126, 	-5126};


const int fourier_table[94] = {	0, 			4403, 		8790, 		13145, 		17451, 		21693, 		25855, 		29922,	 	33878, 		37710,
								41403, 		44945, 		48321, 		51520, 		54531, 		57343, 		59945,	 	62329, 		64486,	 	66409,
								68092, 		69528,	 	70714, 		71646, 		72322, 		72739,	 	72898,	 	72798, 		72442, 		71831,
								70970, 		69863, 		68516, 		66935, 		65126, 		63100, 		60864,	 	58429,	 	55805, 		53004,
								50038, 		46920, 		43664, 		40283, 		36791, 		33205, 		29538, 		25807, 		22028, 		18216,
								14387, 		10559, 		6747, 		2967, 		-764, 		-4431, 		-8019, 		-11511, 	-14893, 	-18150,
								-21269, 	-24236, 	-27039, 	-29664, 	-32101, 	-34338, 	-36367, 	-38177, 	-39760, 	-41110,
								-42219, 	-43083, 	-43695, 	-44054, 	-44157, 	-44001, 	-43587, 	-42915, 	-41986, 	-40803,
								-39370, 	-37691, 	-35772, 	-33618, 	-31239, 	-28640, 	-25833, 	-22827, 	-19632, 	-16260,
								-12723, 	-9035, 		-5208, 		-1256};

float sin1(float phase, uint32_t i) {
  int x1 = (int) phase % SINE_ARR_SIZE;
  if (x1 < 0) x1 += SINE_ARR_SIZE;
  int x2 = (x1 + 1) % SINE_ARR_SIZE;
  float y = (sine_table[x2] - sine_table[x1])
      * ((float) ((int) (SINE_ARR_SIZE * 0.001 * i * 100) % ((SINE_ARR_SIZE+1)*100)) / 100 - x1)
      + sine_table[x1];
  return y;
}

float fourier(float phase,uint32_t i) {
  int x1 = (int) phase % FOURIER_ARR_SIZE;
  if (x1 < 0) x1 += FOURIER_ARR_SIZE;
  int x2 = (x1 + 1) % FOURIER_ARR_SIZE;
  float y = (fourier_table[x2] - fourier_table[x1])
      * ((float) ((int) (FOURIER_ARR_SIZE * 0.001 * i * 100) % ((FOURIER_ARR_SIZE+1)*100)) / 100 - x1)
      + fourier_table[x1];
  return y;
}
